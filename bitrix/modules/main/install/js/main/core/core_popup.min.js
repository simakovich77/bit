(function(t){if(BX.PopupWindowManager)return;BX.PopupWindowManager={_popups:[],_currentPopup:null,create:function(t,e,o){var i=-1;if((i=this._getPopupIndex(t))!==-1)return this._popups[i];var n=new BX.PopupWindow(t,e,o);BX.addCustomEvent(n,"onPopupShow",BX.delegate(this.onPopupShow,this));BX.addCustomEvent(n,"onPopupClose",BX.delegate(this.onPopupClose,this));BX.addCustomEvent(n,"onPopupDestroy",BX.delegate(this.onPopupDestroy,this));this._popups.push(n);return n},onPopupShow:function(t){if(this._currentPopup!==null)this._currentPopup.close();this._currentPopup=t},onPopupClose:function(t){this._currentPopup=null},onPopupDestroy:function(t){var e=-1;if((e=this._getPopupIndex(t.uniquePopupId))!==-1)this._popups=BX.util.deleteFromArray(this._popups,e)},getCurrentPopup:function(){return this._currentPopup},isPopupExists:function(t){return this._getPopupIndex(t)!==-1},_getPopupIndex:function(t){var e=-1;for(var o=0;o<this._popups.length;o++)if(this._popups[o].uniquePopupId==t)return o;return e}};BX.PopupWindow=function(e,o,i){BX.onCustomEvent("onPopupWindowInit",[e,o,i]);this.uniquePopupId=e;this.params=i||{};this.params.zIndex=parseInt(this.params.zIndex);this.params.zIndex=isNaN(this.params.zIndex)?0:this.params.zIndex;this.buttons=this.params.buttons&&BX.type.isArray(this.params.buttons)?this.params.buttons:[];this.offsetTop=BX.PopupWindow.getOption("offsetTop");this.offsetLeft=BX.PopupWindow.getOption("offsetLeft");this.firstShow=false;this.bordersWidth=20;this.bindElementPos=null;this.closeIcon=null;this.angle=null;this.overlay=null;this.titleBar=null;this.bindOptions=typeof this.params.bindOptions=="object"?this.params.bindOptions:{};this.isAutoHideBinded=false;this.closeByEsc=!!this.params.closeByEsc;this.isCloseByEscBinded=false;if(this.params.parentPopup instanceof BX.PopupWindow){this.parentPopup=this.params.parentPopup;this.appendContainer=this.params.parentPopup.contentContainer;this.params.offsetTop=(this.params.offsetTop?this.params.offsetTop:0)-(BX.PopupWindow.fullscreenStatus?0:this.parentPopup.popupContainer.offsetTop);this.params.offsetLeft=(this.params.offsetLeft?this.params.offsetLeft:0)-(BX.PopupWindow.fullscreenStatus?0:this.parentPopup.popupContainer.offsetLeft)}else{this.parentPopup=null;this.appendContainer=document.body}this.dragged=false;this.dragPageX=0;this.dragPageY=0;if(this.params.events){for(var n in this.params.events)BX.addCustomEvent(this,n,this.params.events[n])}this.popupContainer=document.createElement("DIV");BX.adjust(this.popupContainer,{props:{id:e},style:{zIndex:this.getZindex(),position:"absolute",display:"none",top:"0px",left:"0px"}});if(i.darkMode){BX.addClass(this.popupContainer,"popup-window-dark")}var s="popup-window";if(i.lightShadow)s+=" popup-window-light";if(i.titleBar)s+=i.lightShadow?" popup-window-titlebar-light":" popup-window-titlebar";if(i.className&&BX.type.isNotEmptyString(i.className))s+=" "+i.className;this.popupContainer.innerHTML=['<table class="',s,'" cellspacing="0"> 		<tr class="popup-window-top-row"> 			<td class="popup-window-left-column"><div class="popup-window-left-spacer"></div></td> 			<td class="popup-window-center-column">',i.titleBar?'<div class="popup-window-titlebar" id="popup-window-titlebar-'+e+'"></div>':"",'</td> 			<td class="popup-window-right-column"><div class="popup-window-right-spacer"></div></td> 		</tr> 		<tr class="popup-window-content-row"> 			<td class="popup-window-left-column"></td> 			<td class="popup-window-center-column"><div class="popup-window-content" id="popup-window-content-',e,'"> 			</div></td> 			<td class="popup-window-right-column"></td> 		</tr> 		<tr class="popup-window-bottom-row"> 			<td class="popup-window-left-column"></td> 			<td class="popup-window-center-column"></td> 			<td class="popup-window-right-column"></td> 		</tr> 	</table>'].join("");this.appendContainer.appendChild(this.popupContainer);if(i.closeIcon){this.popupContainer.appendChild(this.closeIcon=BX.create("a",{props:{className:"popup-window-close-icon"+(i.titleBar?" popup-window-titlebar-close-icon":""),href:""},style:typeof i.closeIcon=="object"?i.closeIcon:{},events:{click:BX.proxy(this._onCloseIconClick,this)}}));if(BX.browser.IsIE())BX.adjust(this.closeIcon,{attrs:{hidefocus:"true"}})}this.contentContainer=BX("popup-window-content-"+e);this.titleBar=BX("popup-window-titlebar-"+e);this.buttonsContainer=this.buttonsHr=null;if(i.angle)this.setAngle(i.angle);if(i.overlay)this.setOverlay(i.overlay);this.setOffset(this.params);this.setBindElement(o);this.setTitleBar(this.params.titleBar);this.setContent(this.params.content);this.setButtons(this.params.buttons);if(this.params.bindOnResize!==false){BX.bind(t,"resize",BX.proxy(this._onResizeWindow,this))}};BX.PopupWindow.prototype.setContent=function(t){if(!this.contentContainer||!t)return;if(BX.type.isElementNode(t)){BX.cleanNode(this.contentContainer);this.contentContainer.appendChild(t.parentNode?t.parentNode.removeChild(t):t);t.style.display="block"}else if(BX.type.isString(t)){this.contentContainer.innerHTML=t}else this.contentContainer.innerHTML="&nbsp;"};BX.PopupWindow.prototype.setButtons=function(t){this.buttons=t&&BX.type.isArray(t)?t:[];if(this.buttonsHr)BX.remove(this.buttonsHr);if(this.buttonsContainer)BX.remove(this.buttonsContainer);if(this.buttons.length>0&&this.contentContainer){var e=[];for(var o=0;o<this.buttons.length;o++){var i=this.buttons[o];if(i==null||!BX.is_subclass_of(i,BX.PopupWindowButton))continue;i.popupWindow=this;e.push(i.render())}this.buttonsHr=this.contentContainer.parentNode.appendChild(BX.create("div",{props:{className:"popup-window-hr popup-window-buttons-hr"},children:[BX.create("i",{})]}));this.buttonsContainer=this.contentContainer.parentNode.appendChild(BX.create("div",{props:{className:"popup-window-buttons"},children:e}))}};BX.PopupWindow.prototype.setBindElement=function(t){if(!t||typeof t!="object")return;if(BX.type.isDomNode(t)||BX.type.isNumber(t.top)&&BX.type.isNumber(t.left))this.bindElement=t;else if(BX.type.isNumber(t.clientX)&&BX.type.isNumber(t.clientY)){BX.fixEventPageXY(t);this.bindElement={left:t.pageX,top:t.pageY,bottom:t.pageY}}};BX.PopupWindow.prototype.getBindElementPos=function(t){if(BX.type.isDomNode(t)){return BX.pos(t,false)}else if(t&&typeof t=="object"){if(!BX.type.isNumber(t.bottom))t.bottom=t.top;return t}else{var e=BX.GetWindowInnerSize();var o=BX.GetWindowScrollPos();var i=this.popupContainer.offsetWidth;var n=this.popupContainer.offsetHeight;this.bindOptions.forceTop=true;return{left:e.innerWidth/2-i/2+o.scrollLeft,top:e.innerHeight/2-n/2+o.scrollTop,bottom:e.innerHeight/2-n/2+o.scrollTop,windowSize:e,windowScroll:o,popupWidth:i,popupHeight:n}}};BX.PopupWindow.prototype.setAngle=function(t){var e=this.params.lightShadow?"popup-window-light-angly":"popup-window-angly";if(this.angle==null){var o=this.bindOptions.position&&this.bindOptions.position=="top"?"bottom":"top";var i=BX.PopupWindow.getOption(o=="top"?"angleMinTop":"angleMinBottom");var n=BX.type.isNumber(t.offset)?t.offset:0;var s=BX.PopupWindow.getOption("angleLeftOffset",null);if(n>0&&BX.type.isNumber(s))n+=s-BX.PopupWindow.defaultOptions.angleLeftOffset;this.angle={element:BX.create("div",{props:{className:e+" "+e+"-"+o}}),position:o,offset:0,defaultOffset:Math.max(n,i)};this.popupContainer.appendChild(this.angle.element)}if(typeof t=="object"&&t.position&&BX.util.in_array(t.position,["top","right","bottom","left","hide"])){BX.removeClass(this.angle.element,e+"-"+this.angle.position);BX.addClass(this.angle.element,e+"-"+t.position);this.angle.position=t.position}if(typeof t=="object"&&BX.type.isNumber(t.offset)){var p=t.offset;var a,u;if(this.angle.position=="top"){a=BX.PopupWindow.getOption("angleMinTop");u=this.popupContainer.offsetWidth-BX.PopupWindow.getOption("angleMaxTop");u=u<a?Math.max(a,p):u;this.angle.offset=Math.min(Math.max(a,p),u);this.angle.element.style.left=this.angle.offset+"px";this.angle.element.style.marginLeft="auto"}else if(this.angle.position=="bottom"){a=BX.PopupWindow.getOption("angleMinBottom");u=this.popupContainer.offsetWidth-BX.PopupWindow.getOption("angleMaxBottom");u=u<a?Math.max(a,p):u;this.angle.offset=Math.min(Math.max(a,p),u);this.angle.element.style.marginLeft=this.angle.offset+"px";this.angle.element.style.left="auto"}else if(this.angle.position=="right"){a=BX.PopupWindow.getOption("angleMinRight");u=this.popupContainer.offsetHeight-BX.PopupWindow.getOption("angleMaxRight");u=u<a?Math.max(a,p):u;this.angle.offset=Math.min(Math.max(a,p),u);this.angle.element.style.top=this.angle.offset+"px"}else if(this.angle.position=="left"){a=BX.PopupWindow.getOption("angleMinLeft");u=this.popupContainer.offsetHeight-BX.PopupWindow.getOption("angleMaxLeft");u=u<a?Math.max(a,p):u;this.angle.offset=Math.min(Math.max(a,p),u);this.angle.element.style.top=this.angle.offset+"px"}}};BX.PopupWindow.prototype.isTopAngle=function(){return this.angle!=null&&this.angle.position=="top"};BX.PopupWindow.prototype.isBottomAngle=function(){return this.angle!=null&&this.angle.position=="bottom"};BX.PopupWindow.prototype.isTopOrBottomAngle=function(){return this.angle!=null&&BX.util.in_array(this.angle.position,["top","bottom"])};BX.PopupWindow.prototype.getAngleHeight=function(){return this.isTopOrBottomAngle()?BX.PopupWindow.getOption("angleTopOffset"):0};BX.PopupWindow.prototype.setOffset=function(t){if(typeof t!="object")return;if(t.offsetLeft&&BX.type.isNumber(t.offsetLeft))this.offsetLeft=t.offsetLeft+BX.PopupWindow.getOption("offsetLeft");if(t.offsetTop&&BX.type.isNumber(t.offsetTop))this.offsetTop=t.offsetTop+BX.PopupWindow.getOption("offsetTop")};BX.PopupWindow.prototype.setTitleBar=function(t){if(!this.titleBar||typeof t!="object"||!BX.type.isDomNode(t.content))return;this.titleBar.innerHTML="";this.titleBar.appendChild(t.content);if(this.params.draggable){this.titleBar.parentNode.style.cursor="move";BX.bind(this.titleBar.parentNode,"mousedown",BX.proxy(this._startDrag,this))}};BX.PopupWindow.prototype.setClosingByEsc=function(t){t=!!t;if(t){this.closeByEsc=true;if(!this.isCloseByEscBinded){BX.bind(document,"keyup",BX.proxy(this._onKeyUp,this));this.isCloseByEscBinded=true}}else{this.closeByEsc=false;if(this.isCloseByEscBinded){BX.unbind(document,"keyup",BX.proxy(this._onKeyUp,this));this.isCloseByEscBinded=false}}};BX.PopupWindow.prototype.setOverlay=function(t){if(this.overlay==null){this.overlay={element:BX.create("div",{props:{className:"popup-window-overlay",id:"popup-window-overlay-"+this.uniquePopupId}})};this.adjustOverlayZindex();this.resizeOverlay();this.appendContainer.appendChild(this.overlay.element)}if(t&&t.opacity&&BX.type.isNumber(t.opacity)&&t.opacity>=0&&t.opacity<=100){if(BX.browser.IsIE()&&!BX.browser.IsIE9())this.overlay.element.style.filter="alpha(opacity="+t.opacity+")";else{this.overlay.element.style.filter="none";this.overlay.element.style.opacity=parseFloat(t.opacity/100).toPrecision(3)}}if(t&&t.backgroundColor)this.overlay.element.style.backgroundColor=t.backgroundColor};BX.PopupWindow.prototype.removeOverlay=function(){if(this.overlay!=null&&this.overlay.element!=null)BX.remove(this.overlay.element);this.overlay=null};BX.PopupWindow.prototype.hideOverlay=function(){if(this.overlay!=null&&this.overlay.element!=null)this.overlay.element.style.display="none"};BX.PopupWindow.prototype.showOverlay=function(){if(this.overlay!=null&&this.overlay.element!=null)this.overlay.element.style.display="block"};BX.PopupWindow.prototype.resizeOverlay=function(){if(this.overlay!=null&&this.overlay.element!=null){if(this.parentPopup){this.overlay.element.style.width=this.parentPopup.popupContainer.offsetWidth+"px";this.overlay.element.style.height=this.parentPopup.popupContainer.offsetHeight+"px"}else{var t=BX.GetWindowScrollSize();var e=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight);this.overlay.element.style.width=t.scrollWidth+"px";this.overlay.element.style.height=e+"px"}}};BX.PopupWindow.prototype.getZindex=function(){if(this.overlay!=null)return BX.PopupWindow.getOption("popupOverlayZindex")+this.params.zIndex;else return BX.PopupWindow.getOption("popupZindex")+this.params.zIndex};BX.PopupWindow.prototype.adjustOverlayZindex=function(){if(this.overlay!=null&&this.overlay.element!=null){this.overlay.element.style.zIndex=parseInt(this.popupContainer.style.zIndex)-1}};BX.PopupWindow.prototype.show=function(){if(!this.firstShow){BX.onCustomEvent(this,"onPopupFirstShow",[this]);this.firstShow=true}BX.onCustomEvent(this,"onPopupShow",[this]);this.showOverlay();this.popupContainer.style.display="block";this.adjustPosition();BX.onCustomEvent(this,"onAfterPopupShow",[this]);if(this.closeByEsc&&!this.isCloseByEscBinded){BX.bind(document,"keyup",BX.proxy(this._onKeyUp,this));this.isCloseByEscBinded=true}if(this.params.autoHide&&!this.isAutoHideBinded){setTimeout(BX.proxy(function(){if(this.isShown()){this.isAutoHideBinded=true;BX.bind(this.popupContainer,"click",this.cancelBubble);BX.bind(document,"click",BX.proxy(this.close,this))}},this),100)}};BX.PopupWindow.prototype.isShown=function(){return this.popupContainer.style.display=="block"};BX.PopupWindow.prototype.cancelBubble=function(e){if(!e)e=t.event;if(e.stopPropagation)e.stopPropagation();else e.cancelBubble=true};BX.PopupWindow.prototype.close=function(t){if(!this.isShown())return;if(t&&!(BX.getEventButton(t)&BX.MSLEFT))return true;BX.onCustomEvent(this,"onPopupClose",[this,t]);this.hideOverlay();this.popupContainer.style.display="none";if(this.isCloseByEscBinded){BX.unbind(document,"keyup",BX.proxy(this._onKeyUp,this));this.isCloseByEscBinded=false}setTimeout(BX.proxy(this._close,this),0)};BX.PopupWindow.prototype._close=function(){if(this.params.autoHide&&this.isAutoHideBinded){this.isAutoHideBinded=false;BX.unbind(this.popupContainer,"click",this.cancelBubble);BX.unbind(document,"click",BX.proxy(this.close,this))}};BX.PopupWindow.prototype._onCloseIconClick=function(e){e=e||t.event;this.close(e);BX.PreventDefault(e)};BX.PopupWindow.prototype._onKeyUp=function(e){e=e||t.event;if(e.keyCode==27){i(this.getZindex(),BX.proxy(this.close,this))}};BX.PopupWindow.prototype.destroy=function(){BX.onCustomEvent(this,"onPopupDestroy",[this]);BX.unbindAll(this);BX.unbind(document,"keyup",BX.proxy(this._onKeyUp,this));BX.unbind(document,"click",BX.proxy(this.close,this));BX.unbind(document,"mousemove",BX.proxy(this._moveDrag,this));BX.unbind(document,"mouseup",BX.proxy(this._stopDrag,this));BX.unbind(t,"resize",BX.proxy(this._onResizeWindow,this));BX.remove(this.popupContainer);this.removeOverlay()};BX.PopupWindow.prototype.enterFullScreen=function(){if(BX.PopupWindow.fullscreenStatus){if(document.cancelFullScreen)document.cancelFullScreen();else if(document.mozCancelFullScreen)document.mozCancelFullScreen();else if(document.webkitCancelFullScreen)document.webkitCancelFullScreen()}else{if(BX.browser.IsChrome()||BX.browser.IsSafari()){this.contentContainer.webkitRequestFullScreen(this.contentContainer.ALLOW_KEYBOARD_INPUT);BX.bind(t,"webkitfullscreenchange",this.fullscreenBind=BX.proxy(this.eventFullScreen,this))}else if(BX.browser.IsFirefox()){this.contentContainer.mozRequestFullScreen(this.contentContainer.ALLOW_KEYBOARD_INPUT);BX.bind(t,"mozfullscreenchange",this.fullscreenBind=BX.proxy(this.eventFullScreen,this))}}};BX.PopupWindow.prototype.eventFullScreen=function(e){if(BX.PopupWindow.fullscreenStatus){if(BX.browser.IsChrome()||BX.browser.IsSafari())BX.unbind(t,"webkitfullscreenchange",this.fullscreenBind);else if(BX.browser.IsFirefox())BX.unbind(t,"mozfullscreenchange",this.fullscreenBind);BX.removeClass(this.contentContainer,"popup-window-fullscreen",[this.contentContainer]);BX.PopupWindow.fullscreenStatus=false;BX.onCustomEvent(this,"onPopupFullscreenLeave");this.adjustPosition()}else{BX.addClass(this.contentContainer,"popup-window-fullscreen");BX.PopupWindow.fullscreenStatus=true;BX.onCustomEvent(this,"onPopupFullscreenEnter",[this.contentContainer]);this.adjustPosition()}};BX.PopupWindow.prototype.adjustPosition=function(t){if(t&&typeof t=="object")this.bindOptions=t;var e=this.getBindElementPos(this.bindElement);if(!this.bindOptions.forceBindPosition&&this.bindElementPos!=null&&e.top==this.bindElementPos.top&&e.left==this.bindElementPos.left){return}this.bindElementPos=e;var o=e.windowSize?e.windowSize:BX.GetWindowInnerSize();var i=e.windowScroll?e.windowScroll:BX.GetWindowScrollPos();var n=e.popupWidth?e.popupWidth:this.popupContainer.offsetWidth;var s=e.popupHeight?e.popupHeight:this.popupContainer.offsetHeight;var p=BX.PopupWindow.getOption("angleTopOffset");var a=this.bindElementPos.left+this.offsetLeft-(this.isTopOrBottomAngle()?BX.PopupWindow.getOption("angleLeftOffset"):0);if(!this.bindOptions.forceLeft&&a+n+this.bordersWidth>=o.innerWidth+i.scrollLeft&&o.innerWidth+i.scrollLeft-n-this.bordersWidth>0){var u=a;a=o.innerWidth+i.scrollLeft-n-this.bordersWidth;if(this.isTopOrBottomAngle()){this.setAngle({offset:u-a+this.angle.defaultOffset})}}else if(this.isTopOrBottomAngle()){this.setAngle({offset:this.angle.defaultOffset+(a<0?a:0)})}if(a<0)a=0;var r=0;if(this.bindOptions.position&&this.bindOptions.position=="top"){r=this.bindElementPos.top-s-this.offsetTop-(this.isBottomAngle()?p:0);if(r<0||!this.bindOptions.forceTop&&r<i.scrollTop){r=this.bindElementPos.bottom+this.offsetTop;if(this.angle!=null){r+=p;this.setAngle({position:"top"})}}else if(this.isTopAngle()){r=r-p+BX.PopupWindow.getOption("positionTopXOffset");this.setAngle({position:"bottom"})}else{r+=BX.PopupWindow.getOption("positionTopXOffset")}}else{r=this.bindElementPos.bottom+this.offsetTop+this.getAngleHeight();if(!this.bindOptions.forceTop&&r+s>o.innerHeight+i.scrollTop&&this.bindElementPos.top-s-this.getAngleHeight()>=0){r=this.bindElementPos.top-s;if(this.isTopOrBottomAngle()){r-=p;this.setAngle({position:"bottom"})}r+=BX.PopupWindow.getOption("positionTopXOffset")}else if(this.isBottomAngle()){r+=p;this.setAngle({position:"top"})}}if(!this.parentPopup&&r<0)r=0;BX.adjust(this.popupContainer,{style:{top:r+"px",left:a+"px",zIndex:this.getZindex()}});this.adjustOverlayZindex()};BX.PopupWindow.prototype._onResizeWindow=function(t){if(this.isShown()){this.adjustPosition();if(this.overlay!=null)this.resizeOverlay()}};BX.PopupWindow.prototype.move=function(t,e){var o=parseInt(this.popupContainer.style.left)+t;var i=parseInt(this.popupContainer.style.top)+e;if(typeof this.params.draggable=="object"&&this.params.draggable.restrict){if(!this.parentPopup&&o<0)o=0;var n=BX.GetWindowScrollSize();var s=this.popupContainer.offsetWidth;var p=this.popupContainer.offsetHeight;if(o>n.scrollWidth-s)o=n.scrollWidth-s;if(i>n.scrollHeight-p)i=n.scrollHeight-p;if(!this.parentPopup&&i<0)i=0}this.popupContainer.style.left=o+"px";this.popupContainer.style.top=i+"px"};BX.PopupWindow.prototype._startDrag=function(e){e=e||t.event;BX.fixEventPageXY(e);this.dragPageX=e.pageX;this.dragPageY=e.pageY;this.dragged=false;BX.bind(document,"mousemove",BX.proxy(this._moveDrag,this));BX.bind(document,"mouseup",BX.proxy(this._stopDrag,this));if(document.body.setCapture)document.body.setCapture();document.body.ondrag=BX.False;document.body.onselectstart=BX.False;document.body.style.cursor="move";document.body.style.MozUserSelect="none";this.popupContainer.style.MozUserSelect="none";return BX.PreventDefault(e)};BX.PopupWindow.prototype._moveDrag=function(e){e=e||t.event;BX.fixEventPageXY(e);if(this.dragPageX==e.pageX&&this.dragPageY==e.pageY)return;this.move(e.pageX-this.dragPageX,e.pageY-this.dragPageY);this.dragPageX=e.pageX;this.dragPageY=e.pageY;if(!this.dragged){BX.onCustomEvent(this,"onPopupDragStart");this.dragged=true}BX.onCustomEvent(this,"onPopupDrag")};BX.PopupWindow.prototype._stopDrag=function(t){if(document.body.releaseCapture)document.body.releaseCapture();BX.unbind(document,"mousemove",BX.proxy(this._moveDrag,this));BX.unbind(document,"mouseup",BX.proxy(this._stopDrag,this));document.body.ondrag=null;document.body.onselectstart=null;document.body.style.cursor="";document.body.style.MozUserSelect="";this.popupContainer.style.MozUserSelect="";BX.onCustomEvent(this,"onPopupDragEnd");this.dragged=false;return BX.PreventDefault(t)};BX.PopupWindow.options={};BX.PopupWindow.defaultOptions={angleLeftOffset:15,positionTopXOffset:0,angleTopOffset:8,popupZindex:1e3,popupOverlayZindex:1100,angleMinLeft:10,angleMaxLeft:10,angleMinRight:10,angleMaxRight:10,angleMinBottom:7,angleMaxBottom:25,angleMinTop:7,angleMaxTop:25,offsetLeft:0,offsetTop:0};BX.PopupWindow.setOptions=function(t){if(!t||typeof t!="object")return;for(var e in t)BX.PopupWindow.options[e]=t[e]};BX.PopupWindow.getOption=function(t,e){if(typeof BX.PopupWindow.options[t]!="undefined")return BX.PopupWindow.options[t];else if(typeof e!="undefined")return e;else return BX.PopupWindow.defaultOptions[t]};BX.PopupWindowButton=function(t){this.popupWindow=null;this.params=t||{};this.text=this.params.text||"";this.id=this.params.id||"";this.className=this.params.className||"";this.events=this.params.events||{};this.contextEvents={};for(var e in this.events)this.contextEvents[e]=BX.proxy(this.events[e],this);this.nameNode=BX.create("span",{props:{className:"popup-window-button-text"},text:this.text});this.buttonNode=BX.create("span",{props:{className:"popup-window-button"+(this.className.length>0?" "+this.className:""),id:this.id},children:[BX.create("span",{props:{className:"popup-window-button-left"}}),this.nameNode,BX.create("span",{props:{className:"popup-window-button-right"}})],events:this.contextEvents})};BX.PopupWindowButton.prototype.render=function(){return this.buttonNode};BX.PopupWindowButton.prototype.setName=function(t){this.text=t||"";if(this.nameNode){BX.cleanNode(this.nameNode);BX.adjust(this.nameNode,{text:this.text})}};BX.PopupWindowButton.prototype.setClassName=function(t){if(this.buttonNode){if(BX.type.isString(this.className)&&this.className!="")BX.removeClass(this.buttonNode,this.className);BX.addClass(this.buttonNode,t)}this.className=t};BX.PopupWindowButtonLink=function(t){BX.PopupWindowButtonLink.superclass.constructor.apply(this,arguments);this.nameNode=BX.create("span",{props:{className:"popup-window-button-link-text"},text:this.text,events:this.contextEvents});this.buttonNode=BX.create("span",{props:{className:"popup-window-button popup-window-button-link"+(this.className.length>0?" "+this.className:""),id:this.id},children:[this.nameNode]})};BX.extend(BX.PopupWindowButtonLink,BX.PopupWindowButton);BX.PopupMenu={Data:{},currentItem:null,show:function(t,e,o,i){if(this.currentItem!==null){this.currentItem.popupWindow.close()}this.currentItem=this.create(t,e,o,i);this.currentItem.popupWindow.show()},create:function(t,e,o,i){if(!this.Data[t]){this.Data[t]=new BX.PopupMenuWindow(t,e,o,i)}return this.Data[t]},getCurrentMenu:function(){return this.currentItem},getMenuById:function(t){return this.Data[t]?this.Data[t]:null},destroy:function(t){var e=this.getMenuById(t);if(e){if(this.currentItem==e){this.currentItem=null}e.popupWindow.destroy();delete this.Data[t]}}};BX.PopupMenuWindow=function(t,e,o,i){this.id=t;this.bindElement=e;this.menuItems=[];this.itemsContainer=null;if(o&&BX.type.isArray(o)){for(var n=0;n<o.length;n++){this.__addMenuItem(o[n],null)}}this.params=i&&typeof i=="object"?i:{};this.popupWindow=this.__createPopup()};BX.PopupMenuWindow.prototype.__createItem=function(t,e){if(e>0){t.layout.hr=BX.create("div",{props:{className:"popup-window-hr"},children:[BX.create("i",{})]})}if(t.delimiter){t.layout.item=BX.create("span",{props:{className:"popup-window-delimiter"},html:"<i></i>"})}else{t.layout.item=BX.create(!!t.href?"a":"span",{props:{className:"menu-popup-item"+(BX.type.isNotEmptyString(t.className)?" "+t.className:" menu-popup-no-icon")},attrs:{title:t.title?t.title:"",onclick:t.onclick&&BX.type.isString(t.onclick)?t.onclick:"",target:t.target?t.target:""},events:t.onclick&&BX.type.isFunction(t.onclick)?{click:BX.proxy(this.onItemClick,{obj:this,item:t})}:null,children:[BX.create("span",{props:{className:"menu-popup-item-left"}}),BX.create("span",{props:{className:"menu-popup-item-icon"}}),t.layout.text=BX.create("span",{props:{className:"menu-popup-item-text"},html:t.text}),BX.create("span",{props:{className:"menu-popup-item-right"}})]});if(t.href)t.layout.item.href=t.href}return t};BX.PopupMenuWindow.prototype.__createPopup=function(){var t=[];for(var e=0;e<this.menuItems.length;e++){this.__createItem(this.menuItems[e],e);if(this.menuItems[e].layout.hr!=null){t.push(this.menuItems[e].layout.hr)}t.push(this.menuItems[e].layout.item)}var o=new BX.PopupWindow("menu-popup-"+this.id,this.bindElement,{closeByEsc:typeof this.params.closeByEsc!="undefined"?this.params.closeByEsc:false,bindOptions:typeof this.params.bindOptions=="object"?this.params.bindOptions:{},angle:typeof this.params.angle!="undefined"?this.params.angle:false,zIndex:this.params.zIndex?this.params.zIndex:0,overlay:typeof this.params.overlay=="object"?this.params.overlay:null,autoHide:typeof this.params.autoHide!="undefined"?this.params.autoHide:true,offsetTop:this.params.offsetTop?this.params.offsetTop:1,offsetLeft:this.params.offsetLeft?this.params.offsetLeft:0,lightShadow:typeof this.params.lightShadow!="undefined"?this.params.lightShadow:true,content:BX.create("div",{props:{className:"menu-popup"},children:[this.itemsContainer=BX.create("div",{props:{className:"menu-popup-items"},children:t})]})});if(this.params&&this.params.events){for(var i in this.params.events){if(this.params.events.hasOwnProperty(i)){BX.addCustomEvent(o,i,this.params.events[i])}}}return o};BX.PopupMenuWindow.prototype.onItemClick=function(e){e=e||t.event;this.item.onclick.call(this.obj,e,this.item)};BX.PopupMenuWindow.prototype.addMenuItem=function(t,e){var o=this.__addMenuItem(t,e);if(o<0){return false}this.__createItem(t,o);var i=this.getMenuItem(e);if(i!=null){if(i.layout.hr==null){i.layout.hr=BX.create("div",{props:{className:"popup-window-hr"},children:[BX.create("i",{})]});this.itemsContainer.insertBefore(i.layout.hr,i.layout.item)}if(t.layout.hr!=null){this.itemsContainer.insertBefore(t.layout.hr,i.layout.hr)}this.itemsContainer.insertBefore(t.layout.item,i.layout.hr)}else{if(t.layout.hr!=null){this.itemsContainer.appendChild(t.layout.hr)}this.itemsContainer.appendChild(t.layout.item)}return true};BX.PopupMenuWindow.prototype.__addMenuItem=function(t,e){if(!t||!t.delimiter&&!BX.type.isNotEmptyString(t.text)||t.id&&this.getMenuItem(t.id)!=null){return-1}t.layout={item:null,text:null,hr:null};var o=this.getMenuItemPosition(e);if(o>=0){this.menuItems=BX.util.insertIntoArray(this.menuItems,o,t)}else{this.menuItems.push(t);o=this.menuItems.length-1}return o};BX.PopupMenuWindow.prototype.removeMenuItem=function(t){var e=this.getMenuItem(t);if(!e){return}for(var o=0;o<this.menuItems.length;o++){if(this.menuItems[o]==e){this.menuItems=BX.util.deleteFromArray(this.menuItems,o);break}}if(o==0){if(this.menuItems[0]){this.menuItems[0].layout.hr.parentNode.removeChild(this.menuItems[0].layout.hr);this.menuItems[0].layout.hr=null}}else{e.layout.hr.parentNode.removeChild(e.layout.hr)}e.layout.item.parentNode.removeChild(e.layout.item);e.layout.item=null};BX.PopupMenuWindow.prototype.getMenuItem=function(t){for(var e=0;e<this.menuItems.length;e++){if(this.menuItems[e].id&&this.menuItems[e].id==t){return this.menuItems[e]}}return null};BX.PopupMenuWindow.prototype.getMenuItemPosition=function(t){if(t){for(var e=0;e<this.menuItems.length;e++){if(this.menuItems[e].id&&this.menuItems[e].id==t){return e}}}return-1};t.BXInputPopup=function(t){this.id=t.id||"bx-inp-popup-"+Math.round(Math.random()*1e6);this.handler=t.handler||false;this.values=t.values||false;this.pInput=t.input;this.bValues=!!this.values;this.defaultValue=t.defaultValue||"";this.openTitle=t.openTitle||"";this.className=t.className||"";this.noMRclassName=t.noMRclassName||"ec-no-rm";this.emptyClassName=t.noMRclassName||"ec-label";var e=this;this.curInd=false;if(this.bValues){this.pInput.onfocus=this.pInput.onclick=function(t){if(this.value==e.defaultValue){this.value="";this.className=e.className}e.ShowPopup();return BX.PreventDefault(t)};this.pInput.onblur=function(){if(e.bShowed)setTimeout(function(){e.ClosePopup(true)},200);e.OnChange()}}else{this.pInput.className=this.noMRclassName;this.pInput.onblur=BX.proxy(this.OnChange,this)}};BXInputPopup.prototype={ShowPopup:function(){if(this.bShowed)return;var t=this;if(!this.oPopup){var e,o=BX.create("DIV",{props:{className:"bxecpl-loc-popup "+this.className}});for(var i=0,n=this.values.length;i<n;i++){e=o.appendChild(BX.create("DIV",{props:{id:"bxecmr_"+i},text:this.values[i].NAME,events:{mouseover:function(){BX.addClass(this,"bxecplloc-over")},mouseout:function(){BX.removeClass(this,"bxecplloc-over")},click:function(){var e=this.id.substr("bxecmr_".length);t.pInput.value=t.values[e].NAME;t.curInd=e;t.OnChange();t.ClosePopup(true)}}}));if(this.values[i].DESCRIPTION)e.title=this.values[i].DESCRIPTION;if(this.values[i].CLASS_NAME)BX.addClass(e,this.values[i].CLASS_NAME);if(this.values[i].URL)e.appendChild(BX.create("A",{props:{href:this.values[i].URL,className:"bxecplloc-view",target:"_blank",title:this.openTitle}}))}this.oPopup=new BX.PopupWindow(this.id,this.pInput,{autoHide:true,offsetTop:1,offsetLeft:0,lightShadow:true,closeByEsc:true,content:o});BX.addCustomEvent(this.oPopup,"onPopupClose",BX.proxy(this.ClosePopup,this))}this.oPopup.show();this.pInput.select();this.bShowed=true;BX.onCustomEvent(this,"onInputPopupShow",[this])},ClosePopup:function(t){this.bShowed=false;if(this.pInput.value=="")this.OnChange();BX.onCustomEvent(this,"onInputPopupClose",[this]);if(t===true)this.oPopup.close()},OnChange:function(){var t=this.pInput.value;if(this.bValues){if(this.pInput.value==""||this.pInput.value==this.defaultValue){this.pInput.value=this.defaultValue;this.pInput.className=this.emptyClassName;t=""}else{this.pInput.className=""}}if(isNaN(parseInt(this.curInd))||this.curInd!==false&&t!=this.values[this.curInd].NAME)this.curInd=false;else this.curInd=parseInt(this.curInd);BX.onCustomEvent(this,"onInputPopupChanged",[this,this.curInd,t]);if(this.handler&&typeof this.handler=="function")this.handler({ind:this.curInd,value:t})},Set:function(t,e,o){this.curInd=t;if(this.curInd!==false)this.pInput.value=this.values[this.curInd].NAME;else this.pInput.value=e;if(o!==false)this.OnChange()},Get:function(t){var e=false;if(typeof t=="undefined")t=this.curInd;if(t!==false&&this.values[t])e=this.values[t].ID;return e},GetIndex:function(t){for(var e=0,o=this.values.length;e<o;e++)if(this.values[e].ID==t)return e;return false},Deactivate:function(t){if(this.pInput.value==""||this.pInput.value==this.defaultValue){if(t){this.pInput.value="";this.pInput.className=this.noMRclassName}else if(this.oEC.bUseMR){this.pInput.value=this.defaultValue;this.pInput.className=this.emptyClassName}}this.pInput.disabled=t}};var e=-1,o=null;function i(t,n){if(t===false){if(o&&o.length>0){for(var s=0;s<o.length;s++){o[s]()}o=null;e=-1}}else{if(o===null){o=[];e=-1;BX.defer(i)(false)}if(t>e){e=t;o=[n]}else if(t==e){o.push(n)}}}})(window);
//# sourceMappingURL=core_popup.map.js